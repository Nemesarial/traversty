/*!
  * Traversty: DOM Traversal Utility (c) Rod Vagg (@rvagg) 2011
  * https://github.com/rvagg/traversty
  * License MIT
  *//*global module:true, define:true*/
!function(a,b){typeof module!="undefined"?module.exports=b():typeof define=="function"&&define.amd?define(a,b):this[a]=b()}("traversty",function(){var a=this,b=a.traversty,c=window.document,d=c.documentElement,e=Object.prototype.toString,f=Array.prototype.slice,g=function(a,b,c,d,e){while(d<b.length)if(a[e=b[d++]+c])return e;if(a[c="m"+c.substring(1)])return c}(d,["ms","webkit","moz","o"],"MatchesSelector",0),h=function(a){return e.call(a)==="[object Number]"},i=function(a){return e.call(a)==="[object String]"},j=function(a){return a===void 0},k=function(a){return a&&a.nodeType===1},l=function(a,b){return j(a)&&!h(b)?0:h(a)?a:h(b)?b:null},m=function(a){return i(a)?a:"*"},n=function(a,b){return f.call(b.querySelectorAll(a),0)},o=function(a,b){return a==="*"||b[g](a)},p=n,q=o,r=function(a){return function(b,c){if(/,/.test(b)){var d=[],e=-1,f=c.getElementsByTagName("*");while(++e<f.length)k(f[e])&&q(b,f[e])&&d.push(f[e]);return d}return a(b,c)}},s=function(a){return function(b,c){var d=b.split(","),e=d.length;while(e--)if(a(d[e],c))return!0;return!1}},t=function(a){var b=[],c=-1,d,e;while(++c<a.length){d=-1,e=!1;while(++d<b.length)if(b[d]===a[c]){e=!0;break}e||b.push(a[c])}return b},u=function(a,b){var c=[],d=0,e=a.length;while(d<e)c=c.concat(b(a[d++]));return c},v=function(a,b,c,d){return d=l(c,d),c=m(c),u(a,function(a){var e=d||0,f=[];while(a&&(d===null||e>=0))a=a[b],k(a)&&q(c,a)&&(d===null||e--===0)&&(d===null&&b!=="nextSibling"?f=[a].concat(f):f.push(a));return f})},w=function(){function d(a){this.length=0;if(a){a=t(!a.nodeType&&!j(a.length)?a:[a]);var b=this.length=a.length;while(b--)this[b]=a[b]}}function e(a){return new d(i(a)?p(a,c):a)}return d.prototype={down:function(a,b){return b=l(a,b),a=m(a),w(u(this,function(c){var d=p(a,c);return b===null?d:[d[b]]||[]}))},up:function(a,b){return w(v(this,"parentNode",a,b))},previous:function(a,b){return w(v(this,"previousSibling",a,b))},next:function(a,b){return w(v(this,"nextSibling",a,b))}},e.setSelectorEngine=function(a){var b=a.select||a.sel||a,d,e,f,g=c.createElement("p");g.innerHTML="<a/><i/><b/>",f=g.firstChild;try{q=a.matching?function(b,c){return a.matching([c],b).length>0}:a.is?function(b,c){return a.is(c,b)}:a.matchesSelector?function(b,c){return a.matchesSelector(c,b)}:a.match?function(b,c){return a.match(c,b)}:null,q||(d=a("a",g),q=d.matching?function(b,c){return a(c).matching(b).length>0}:d.is?function(b,c){return a(c).is(b)}:d.matchesSelector?function(b,c){return a(c).matchesSelector(b)}:d.match?function(b,c){return a(c).match(b)}:null);if(!q)throw"Traversty: couldn't find selector engine's `matchesSelector`";q("x,y",g)&&(q=s(q));if(q("x,y",g)||!q("a,p",g))throw"Traversty: couldn't make selector engine's `matchesSelector` work";if((e=b("b,a",g)).length!==2)throw"Traversty: don't know how to use this selector engine";p=e[0]===f?b:r(b);if((e=p("b,a",g)).length!==2||e[0]!==f)throw"Traversty: couldn't make selector engine work"}catch(h){throw i(h)?h:"Traversty: error while figuring out how the selector engine works: "+h}finally{g=null}},e.noConflict=function(){return a.traversty=b,this},e}();return w})