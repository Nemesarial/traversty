/*!
  * Traversty: DOM Traversal Utility (c) Rod Vagg (@rvagg) 2011
  * https://github.com/rvagg/traversty
  * License MIT
  *//*global module:true, define:true*/
!function(a,b){typeof module!="undefined"?module.exports=b():typeof define=="function"&&define.amd?define(a,b):this[a]=b()}("traversty",function(){var a=this,b=a.traversty,c=window.document,d=c.documentElement,e=Object.prototype.toString,f=Array.prototype.slice,g=function(a,b,c,d,e){while(d<b.length)if(a[e=b[d++]+c])return e;if(a[c="m"+c.substring(1)])return c}(d,["ms","webkit","moz","o"],"MatchesSelector",0),h=function(a){return e.call(a)==="[object Number]"},i=function(a){return e.call(a)==="[object String]"},j=function(a){return a===void 0},k=function(a){return a&&a.nodeType===1},l=function(a,b){return j(a)&&!h(b)?0:h(a)?a:h(b)?b:null},m=function(a){return i(a)?a:"*"},n=function(a,b){return f.call(b.querySelectorAll(a),0)},o=function(a,b){return a==="*"||b[g](a)},p=n,q=o,r=function(a,b){return function(c,d){if(/,/.test(c)){var e=[],f=-1,g=d.getElementsByTagName("*");while(++f<g.length)k(g[f])&&b(c,g[f])&&e.push(g[f]);return e}return a(c,d)}},s=function(a){var b=[],c=-1,d,e;while(++c<a.length){d=-1,e=!1;while(++d<b.length)if(b[d]===a[c]){e=!0;break}e||b.push(a[c])}return b},t=function(a,b){var c=[],d=0,e=a.length;while(d<e)c=c.concat(b(a[d++]));return c},u=function(a,b,c,d){return d=l(c,d),c=m(c),t(a,function(a){var e=d||0,f=[];while(a&&(d===null||e>=0))a=a[b],k(a)&&q(c,a)&&(d===null||e--===0)&&(d===null&&b!=="nextSibling"?f=[a].concat(f):f.push(a));return f})},v=function(){function d(a){this.length=0;if(a){a=s(!a.nodeType&&!j(a.length)?a:[a]);var b=this.length=a.length;while(b--)this[b]=a[b]}}function e(a){return new d(i(a)?p(a,c):a)}return d.prototype={down:function(a,b){return b=l(a,b),a=m(a),v(t(this,function(c){var d=p(a,c);return b===null?d:[d[b]]||[]}))},up:function(a,b){return v(u(this,"parentNode",a,b))},previous:function(a,b){return v(u(this,"previousSibling",a,b))},next:function(a,b){return v(u(this,"nextSibling",a,b))}},e.setSelectorEngine=function(a){var b,d,e,f,g,h=c.createElement("p"),j=a.select||a.sel||a;h.innerHTML="<a/><i/><b/>",e=h.firstChild;try{f=a.matching?function(b,c){return a.matching([c],b).length>0}:a.is?function(b,c){return a.is(c,b)}:a.matchesSelector?function(b,c){return a.matchesSelector(c,b)}:a.match?function(b,c){return a.match(c,b)}:null,f||(b=a("a",h),f=b.matching?function(b,c){return a(c).matching(b).length>0}:b.is?function(b,c){return a(c).is(b)}:b.matchesSelector?function(b,c){return a(c).matchesSelector(b)}:b.match?function(b,c){return a(c).match(b)}:null);if(!f)throw"Traversty: couldn't find selector engine's `matchesSelector`";if(f("x,y",h)||!f("a,p",h))throw"Traversty: couldn't make selector engine's `matchesSelector` work";if((d=j("b,a",h)).length!==2)throw"Traversty: don't know how to use this selector engine";g=d[0]===e?j:r(j,f);if((d=g("b,a",h)).length!==2||d[0]!==e)throw"Traversty: couldn't make selector engine work";q=f,p=g}catch(k){throw i(k)?k:"Traversty: error while figuring out how the selector engine works: "+(k.message||k)}finally{h=null}},e.noConflict=function(){return a.traversty=b,this},e}();return v})