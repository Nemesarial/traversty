/**************************************************************
  * Traversty: DOM Traversal Utility (c) Rod Vagg (@rvagg) 2011
  * https://github.com/rvagg/traversty
  * License: MIT
  */
!function(a,b){typeof module!="undefined"?module.exports=b():typeof define=="function"&&define.amd?define(a,b):this[a]=b()}("traversty",function(){var a=this,b=a.traversty,c=window.document,d=c.documentElement,e=Object.prototype.toString,f=Array.prototype.slice,g=function(a,b,c,d,e){while(d<b.length)if(a[e=b[d++]+c])return e;return a[c="m"+c]?c:0}(d,["msM","webkitM","mozM","oM"],"atchesSelector",0),h=function(a){return e.call(a)==="[object Number]"},i=function(a){return e.call(a)==="[object String]"},j=function(a){return e.call(a)==="[object Function]"},k=function(a){return a===void 0},l=function(a){return a&&a.nodeType===1},m=function(a,b){return k(a)&&!h(b)?0:h(a)?a:h(b)?b:null},n=function(a){return i(a)?a:"*"},o=function(a,b){return f.call(b.querySelectorAll(a),0)},p=function(a,b){return a==="*"||b[g](a)},q=o,r=p,s=function(a,b){return function(c,d){if(/,/.test(c)){var e=[],f=-1,g=d.getElementsByTagName("*");while(++f<g.length)l(g[f])&&b(c,g[f])&&e.push(g[f]);return e}return a(c,d)}},t=function(a){var b=[],c=-1,d,e;while(++c<a.length){d=-1,e=!1;while(++d<b.length)if(b[d]===a[c]){e=!0;break}e||b.push(a[c])}return b},u=function(a,b){var c=[],d=0,e=a.length;while(d<e)c=c.concat(b(a[d++]));return c},v=function(a,b,c,d){return d=m(c,d),c=n(c),u(a,function(a){var e=d||0,f=[];while(a&&(d===null||e>=0))a=a[b],l(a)&&r(c,a)&&(d===null||e--===0)&&(d===null&&b!=="nextSibling"?f=[a].concat(f):f.push(a));return f})},w=function(){function d(a){this.length=0;if(a){a=t(!a.nodeType&&!k(a.length)?a:[a]);var b=this.length=a.length;while(b--)this[b]=a[b]}}function e(a){return new d(i(a)?q(a,c):a)}return d.prototype={down:function(a,b){return b=m(a,b),a=n(a),w(u(this,function(c){var d=q(a,c);return b===null?d:[d[b]]||[]}))},up:function(a,b){return w(v(this,"parentNode",a,b))},previous:function(a,b){return w(v(this,"previousSibling",a,b))},next:function(a,b){return w(v(this,"nextSibling",a,b))}},e.setSelectorEngine=function(a){var b,d,e,f,g,h=c.createElement("p"),k=a.select||a.sel||a;h.innerHTML="<a/><i/><b/>",e=h.firstChild;try{f=j(a.matching)?function(b,c){return a.matching([c],b).length>0}:j(a.is)?function(b,c){return a.is(c,b)}:j(a.matchesSelector)?function(b,c){return a.matchesSelector(c,b)}:j(a.match)?function(b,c){return a.match(c,b)}:null,f||(b=a("a",h),f=j(b.matching)?function(b,c){return a(c).matching(b).length>0}:j(b.is)?function(b,c){return a(c).is(b)}:j(b.matchesSelector)?function(b,c){return a(c).matchesSelector(b)}:j(b.match)?function(b,c){return a(c).match(b)}:null);if(!f)throw"Traversty: couldn't find selector engine's `matchesSelector`";if(f("x,y",h)||!f("a,p",h))throw"Traversty: couldn't make selector engine's `matchesSelector` work";if((d=k("b,a",h)).length!==2)throw"Traversty: don't know how to use this selector engine";g=d[0]===e?k:s(k,f);if((d=g("b,a",h)).length!==2||d[0]!==e)throw"Traversty: couldn't make selector engine work";r=f,q=g}catch(l){throw i(l)?l:"Traversty: error while figuring out how the selector engine works: "+(l.message||l)}finally{h=null}},e.noConflict=function(){return a.traversty=b,this},e}();return w})